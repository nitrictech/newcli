{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "{{.Version}}",
  "title": "JSON schema for the Nitric configuration file",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "name": {
      "type": "string",
      "description": "The name of the project."
    },
    "directory": {
      "type": "string",
      "description": "The directory of the project."
    },
    "services": {
      "type": "array",
      "description": "A list of service configurations.",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "match": {
            "type": "string",
            "description": "The file pattern to match service files."
          },
          "runtime": {
            "type": "string",
            "description": "This is the custom runtime version (is custom if not nil, we auto-detect a standard language runtime)."
          },
          "start": {
            "type": "string",
            "description": "The command to start the service. A $SERVICE_PATH environment variable is available which will specify the relative filepath of each matched service."
          },
          "type": {
            "type": "string",
            "description": "The type of the service.",
            "enum": ["default", "memory-optimized"]
          }
        },
        "required": ["match", "start"]
      }
    },
    "runtimes": {
      "type": "object",
      "description": "A map of runtime configurations.",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "dockerfile": {
            "type": "string",
            "description": "The path to the Dockerfile for this runtime."
          },
          "args": {
            "type": "object",
            "description": "Arguments for the Docker build.",
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "required": ["dockerfile"]
      }
    },
    "preview": {
      "type": "array",
      "minItems": 1,
      "description": "A list of preview features to enable. Checkout https://nitric.io/docs/reference/preview-features for the latest preview features.",
      "items": {
        "type": "string",
        "oneOf": [
          {
            "const": "docker-providers",
            "description": "Use docker containers to distribute nitric providers."
          },
          {
            "const": "beta-providers",
            "description": "Use nitric providers that are currently in beta."
          },
          {
            "const": "sql-databases",
            "description": "Use SQL Databases."
          }
        ]
      }
    }
  },
  "required": ["name", "services"]
}
